# Topology-link-discovery
Suppose you have a set of switches connected together with trunk links and you want to automate the addition of a VLAN on all the switches and addition the VLAN in the allowed list on the trunk links between the switches. What you can do is to discover the links with a script and add a meaningfull description on all the trunk links containing remote-node and remote-port. Then you could parse this information and represent each link as a tuple of local-port, remote-port and remote-node. Also you could add a tuple for a port-channel port containing only the local-port and remote-node as CDP/LLDP won't discover the remote port. 

In this example node_1 and node_2 are interconnected using a port-channel interface. Node_3 and node_4 are both connected to node_1 and node_2. Node_5 is connected to node_4. If you must add a VLAN to the VLAN allowed list you must add these at the VLAN allowed list of the port-channel interface and to the VLAN allowed lists of the member interfaces. Therefor the member interfaces are removed from the object shown in the script. Also the remote-port of the Port-channel interfaces is calculated. The result of the script is printed and is a dict containing all six links in this example. Each link contains node information (node name and node port) of both connected nodes. This makes it quite easy to add all VLAN's on the VLAN allowed lists.

Hans Verkerk - May 2021
